name: 'My Composite Action'
description: 'Combines multiple steps'
runs:
  using: "composite"
  steps:
    - name: è§¦å‘å¯åŠ¨å¼€å§‹ç¼–è¯‘
      id: gitpush
      shell: bash
      run: |
        cd ${GITHUB_WORKSPACE}
        source ${BUILD_PATH}/common.sh && build_openwrt
        
    - name: Telegramæˆ–pushplusä¿¡æ¯é€šçŸ¥
      if: env.PUSH_PLUS_TOKEN && env.INFORMATION_NOTICE == 'PUSH' && steps.gitpush.outcome == 'success' || env.TELEGRAM_BOT_TOKEN && env.INFORMATION_NOTICE == 'TG' && steps.gitpush.outcome == 'success'
      shell: bash
      run: |
        cd ${GITHUB_WORKSPACE}
        if [[ "${{ env.INFORMATION_NOTICE }}" == "TG" ]]; then
          curl -s -X POST -H "Content-Type: application/json" -d '{"chat_id":"${{env.TELEGRAM_CHAT_ID}}", "text":"è§¦å‘å¯åŠ¨${{env.SOURCE}}-${{env.LUCI_EDITION}}ï¼Œç¼–è¯‘${{env.TARGET_PROFILE}}å›ºä»¶ï¼Œè¯·è€å¿ƒç­‰å¾…...... ğŸ˜‹ï¼Œ(${{env.WAREHOUSE_MAN}}-#${{env.RUN_NUMBER}})ï¼Œ($(date +%Yå¹´%mæœˆ%då·%Hæ—¶%Måˆ†))ğŸ’"}' https://api.telegram.org/bot${{env.TELEGRAM_BOT_TOKEN}}/sendMessage
        fi
        if [[ "${{ env.INFORMATION_NOTICE }}" == "PUSH" ]]; then
          curl -s -X POST -H "Content-Type: application/json" -d '{"token":"${{env.PUSH_PLUS_TOKEN}}","title":"è§¦å‘å¯åŠ¨${{env.SOURCE}}-${{env.LUCI_EDITION}}","content":"ç¼–è¯‘${{env.TARGET_PROFILE}}å›ºä»¶ï¼Œè¯·è€å¿ƒç­‰å¾…...... ğŸ˜‹ï¼Œ(${{env.WAREHOUSE_MAN}}-#${{env.RUN_NUMBER}})ï¼Œ($(date +%Yå¹´%mæœˆ%då·%Hæ—¶%Måˆ†))ğŸ’"}' https://www.pushplus.plus/send
        fi
branding:
  icon: "terminal"
  color: "gray-dark"
